theme_bw()+labs(x="",y="")+
theme(axis.text.x = element_text(size=10,color="black",face = "bold"),
axis.text.y = element_text(size=10,color="black",face = "bold"))+
scale_y_continuous(breaks = c(500,1000,1500,2000,2500,3000,3500))+
scale_x_datetime(breaks = "month",date_labels = "%b %Y")
mnfd %>% gt %>% tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2023",rows = Date<"2024-1-1",id ="2023" ,group = "2023") %>%
fmt_number(columns =c(2:5) ,decimals = 2)
mnfd %>% gt %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2023",rows = Date<"2024-1-1",id ="2023" ,group = "2023") %>%
tab_row_group(label = "2024",rows = Date>="2024-1-1",id ="2024" ,group = "2024") %>%
fmt_number(columns =c(2:5) ,decimals = 2)
mnfd %>% gt %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2023",rows = Date<"2024-1-1",id ="2023" ,group = "2023") %>%
tab_row_group(label = "2024",rows = Date>="2024-1-1",id ="2024" ,group = "2024") %>%
fmt_number(columns =c(2:5) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024"))
mnfd %>% gt %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2023",rows = Date<"2024-1-1",id ="2023" ,group = "2023") %>%
tab_row_group(label = "2024",rows = Date>="2024-1-1",id ="2024" ,group = "2024") %>%
fmt_number(columns =c(2:5) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:5),fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1
mnfd %>% gt %>%
mnfd %>% gt %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2023",rows = Date<"2024-1-1",id ="2023" ,group = "2023") %>%
tab_row_group(label = "2024",rows = Date>="2024-1-1",id ="2024" ,group = "2024") %>%
fmt_number(columns =c(2:5) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:5),fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1)
mnfd %>% gt %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2023",rows = Date<"2024-1-1",id ="2023" ,group = "2023") %>%
tab_row_group(label = "2024",rows = Date>="2024-1-1",id ="2024" ,group = "2024") %>%
fmt_number(columns =c(2:5) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:5),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_spanner(label = "Forecast",columns = c(3:5))
mnfd_chart<-
mnfd %>% pivot_longer(!Date,names_to = "cat",values_to = "values") %>%
ggplot(aes(x=Date,y=values,color=cat,group=cat))+geom_line(size=0.7)+
theme_bw()+labs(x="",y="")+
theme(axis.text.x = element_text(size=10,color="black",face = "bold"),
axis.text.y = element_text(size=10,color="black",face = "bold"))+
scale_y_continuous(breaks = c(500,1000,1500,2000,2500,3000,3500))+
scale_x_datetime(breaks = "month",date_labels = "%b %Y") %>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() )
mnfd %>% gt %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2023",rows = Date<"2024-1-1",id ="2023" ,group = "2023") %>%
tab_row_group(label = "2024",rows = Date>="2024-1-1",id ="2024" ,group = "2024") %>%
fmt_number(columns =c(2:5) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:5),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_spanner(label = "Forecast",columns = c(3:5))%>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_spanners() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
mnfd %>% gt %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2023",rows = Date<"2024-1-1",id ="2023" ,group = "2023") %>%
tab_row_group(label = "2024",rows = Date>="2024-1-1",id ="2024" ,group = "2024") %>%
fmt_number(columns =c(2:5) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:5),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_spanner(label = "Forecast",columns = c(3:5))%>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_spanners() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() )
mnfd %>% gt %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2023",rows = Date<"2024-1-1",id ="2023" ,group = "2023") %>%
tab_row_group(label = "2024",rows = Date>="2024-1-1",id ="2024" ,group = "2024") %>%
fmt_number(columns =c(2:5) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:5),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_spanner(label = "Forecast",columns = c(3:5))%>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_spanners() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() )
mnfd %>% gt %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2023",rows = Date<"2024-1-1",id ="2023" ,group = "2023") %>%
tab_row_group(label = "2024",rows = Date>="2024-1-1",id ="2024" ,group = "2024") %>%
fmt_number(columns =c(2:5) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:5),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_spanner(label = "Forecast",columns = c(3:5))%>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_spanners() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() )
mnfd %>% gt %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2023",rows = Date<"2024-1-1",id ="2023" ,group = "2023") %>%
tab_row_group(label = "2024",rows = Date>="2024-1-1",id ="2024" ,group = "2024") %>%
fmt_number(columns =c(2:5) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:5),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_spanner(label = "Forecast",columns = c(3:5))%>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_spanners() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_spanners() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() )
mnfd %>% gt %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2023",rows = Date<"2024-1-1",id ="2023" ,group = "2023") %>%
tab_row_group(label = "2024",rows = Date>="2024-1-1",id ="2024" ,group = "2024") %>%
fmt_number(columns =c(2:5) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:5),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_spanner(label = "Forecast",columns = c(3:5))%>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_spanners() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() )
mnfd %>% gt %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2023",rows = Date<"2024-1-1",id ="2023" ,group = "2023") %>%
tab_row_group(label = "2024",rows = Date>="2024-1-1",id ="2024" ,group = "2024") %>%
fmt_number(columns =c(2:5) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:5),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_spanner(label = "Forecast",columns = c(3:5))%>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_spanners() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() )
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() ) %>%
mnfd %>% gt %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2023",rows = Date<"2024-1-1",id ="2023" ,group = "2023") %>%
tab_row_group(label = "2024",rows = Date>="2024-1-1",id ="2024" ,group = "2024") %>%
fmt_number(columns =c(2:5) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:5),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_spanner(label = "Forecast",columns = c(3:5))%>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_spanners() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() )
mnfd %>% gt %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2023",rows = Date<"2024-1-1",id ="2023" ,group = "2023") %>%
tab_row_group(label = "2024",rows = Date>="2024-1-1",id ="2024" ,group = "2024") %>%
fmt_number(columns =c(2:5) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:5),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_spanner(label = "Forecast",columns = c(3:5))%>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_spanners() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() )
mnfd %>% gt %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2023",rows = Date<"2024-1-1",id ="2023" ,group = "2023") %>%
tab_row_group(label = "2024",rows = Date>="2024-1-1",id ="2024" ,group = "2024") %>%
fmt_number(columns =c(2:5) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:5),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_spanner(label = "Forecast",columns = c(3:5))%>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_spanners() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() ) %>%
tab_stubhead(label = "Year")
mnfd %>% gt %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2023",rows = Date<"2024-1-1",id ="2023" ,group = "2023") %>%
tab_row_group(label = "2024",rows = Date>="2024-1-1",id ="2024" ,group = "2024") %>%
fmt_number(columns =c(2:5) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:5),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_spanner(label = "Forecast",columns = c(3:5))%>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_spanners() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() ) %>%
tab_stubhead(label = "Year") %>%
tab_style(style =list(cell_fill(color="#dcdde1"),cell_text(color="black",weight = "bold")) ,locations =cells_row_groups() )
mnfd %>% gt %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2023",rows = Date<"2024-1-1",id ="2023" ,group = "2023") %>%
tab_row_group(label = "2024",rows = Date>="2024-1-1",id ="2024" ,group = "2024") %>%
fmt_number(columns =c(2:5) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:5),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_spanner(label = "Forecast",columns = c(3:5))%>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_spanners() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() ) %>%
tab_stubhead(label = "Year") %>%
tab_style(style =list(cell_fill(color="#dcdde1"),cell_text(color="black",weight = "bold")) ,locations =cells_row_groups() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stub_summary() )
mnfd_gt<-
mnfd %>% gt %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2023",rows = Date<"2024-1-1",id ="2023" ,group = "2023") %>%
tab_row_group(label = "2024",rows = Date>="2024-1-1",id ="2024" ,group = "2024") %>%
fmt_number(columns =c(2:5) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:5),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_spanner(label = "Forecast",columns = c(3:5))%>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_spanners() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() ) %>%
tab_stubhead(label = "Year") %>%
tab_style(style =list(cell_fill(color="#dcdde1"),cell_text(color="black",weight = "bold")) ,locations =cells_row_groups() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stub_summary() )
summary(lm(price~.,data = mnfd))
summary(lm(price~Hi,data = mnfd))
summary(lm(price~Hi+FPrice,data = mnfd))
summary(lm(price~Hi,data = mnfd))
plot(lm(price~Hi,data = mnfd))
summary(lm(price~Hi,data = mnfd))
modts<-ts(mn$price,start = c(2017,11),end =c(2024,8) ,frequency = 12)
autoplot(modts)
autoplot(decompose(diff( modts)))
moda<-auto.arima(modts)
modf<-forecast(moda,h = 12)
autoplot(modf)
modf
rownames_to_column(data.frame(modf))
data.frame(seq(as.Date("2024-9-1"),by="month",len12))
data.frame(seq(as.Date("2024-9-1"),by="month",len=12))
data.frame(Date=seq(as.Date("2024-9-1"),by="month",len=12))
cbind(
rownames_to_column(data.frame(modf))
,
data.frame(Date=seq(as.Date("2024-9-1"),by="month",len=12))
)
cbind(
data.frame(Date=seq(as.Date("2024-9-1"),by="month",len=12)),
rownames_to_column(data.frame(modf))
)
cbind(
data.frame(Date=seq(as.Date("2024-9-1"),by="month",len=12)),
rownames_to_column(data.frame(modf))
) %>% select(-1)
cbind(
data.frame(Date=seq(as.Date("2024-9-1"),by="month",len=12)),
rownames_to_column(data.frame(modf))
) %>% select(-2)
nxty_model<-
cbind(
data.frame(Date=seq(as.Date("2024-9-1"),by="month",len=12)),
rownames_to_column(data.frame(modf))
) %>% select(-2)
summary(lm(Point.Forecast~.,data = nxty_model))
nxty_model
nxty_model %>% select(-1)
nxty_model %>% select(-1) %>% lm(point.Forecast~.)
nxty_model %>% select(-1) %>% lm(point.Forecast~,m)
summary(lm(,data = nxty_model[,c(-1)]))
summary(lm(Point.Forecast~.,data = nxty_model[,c(-1)]))
summary(lm(Point.Forecast~.,data = nxty_model[,c(-1)]))
pairs(nxty_model[,c(-1)])
nxty_model<-
cbind(
data.frame(Date=seq(as.Date("2024-9-1"),by="month",len=12)),
rownames_to_column(data.frame(modf))
)
nxty_model
cbind(data.frame(Date=seq(as.Date("2024-9-1"),by="month",len=12)),
rownames_to_column(data.frame(modf))) %>% select(-2)
nxty_model<-
cbind(data.frame(Date=seq(as.Date("2024-9-1"),by="month",len=12)),
rownames_to_column(data.frame(modf))) %>% select(-2)
mnfd %>% gt %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2024",rows = Date<"2025-1-1",id ="2024" ,group = "2024") %>%
tab_row_group(label = "2025",rows = Date>="2025-1-1",id ="2025" ,group = "2025") %>%
fmt_number(columns =c(2:6) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:6),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_spanner(label = "Forecast",columns = c(3:6))%>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_spanners() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() ) %>%
tab_stubhead(label = "Year") %>%
tab_style(style =list(cell_fill(color="#dcdde1"),cell_text(color="black",weight = "bold")) ,locations =cells_row_groups() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stub_summary() )
nxty_model
nxty_model %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2024",rows = Date<"2025-1-1",id ="2024" ,group = "2024") %>%
tab_row_group(label = "2025",rows = Date>="2025-1-1",id ="2025" ,group = "2025") %>%
fmt_number(columns =c(2:6) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:6),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_spanner(label = "Forecast",columns = c(3:6))%>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_spanners() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() ) %>%
tab_stubhead(label = "Year") %>%
tab_style(style =list(cell_fill(color="#dcdde1"),cell_text(color="black",weight = "bold")) ,locations =cells_row_groups() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stub_summary() )
nxty_model %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2024",rows = Date<"2025-1-1",id ="2024" ,group = "2024") %>%
tab_row_group(label = "2025",rows = Date>="2025-1-1",id ="2025" ,group = "2025") %>%
fmt_number(columns =c(2:6) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:6),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() ) %>%
tab_stubhead(label = "Year") %>%
tab_style(style =list(cell_fill(color="#dcdde1"),cell_text(color="black",weight = "bold")) ,locations =cells_row_groups() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stub_summary() )
nxty_model %>%gt() %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2024",rows = Date<"2025-1-1",id ="2024" ,group = "2024") %>%
tab_row_group(label = "2025",rows = Date>="2025-1-1",id ="2025" ,group = "2025") %>%
fmt_number(columns =c(2:6) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:6),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() ) %>%
tab_stubhead(label = "Year") %>%
tab_style(style =list(cell_fill(color="#dcdde1"),cell_text(color="black",weight = "bold")) ,locations =cells_row_groups() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stub_summary() )
nxty_model %>%gt() %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2024",rows = Date<"2025-1-1",id ="2024" ,group = "2024") %>%
tab_row_group(label = "2025",rows = Date>="2025-1-1",id ="2025" ,group = "2025") %>%
fmt_number(columns =c(2:6) ,decimals = 2) %>%
row_group_order(groups = c("2024","2025")) %>%
summary_rows(groups = everything(),columns = c(2:6),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() ) %>%
tab_stubhead(label = "Year") %>%
tab_style(style =list(cell_fill(color="#dcdde1"),cell_text(color="black",weight = "bold")) ,locations =cells_row_groups() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stub_summary() )
nxty_model %>%gt() %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2024",rows = Date<"2025-1-1",id ="2024" ,group = "2024") %>%
tab_row_group(label = "2025",rows = Date>="2025-1-1",id ="2025" ,group = "2025") %>%
tab_stubhead(label = "Year") %>%
fmt_number(columns =c(2:6) ,decimals = 2) %>%
row_group_order(groups = c("2024","2025")) %>%
summary_rows(groups = everything(),columns = c(2:6),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() ) %>%
tab_style(style =list(cell_fill(color="#dcdde1"),cell_text(color="black",weight = "bold")) ,locations =cells_row_groups() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stub_summary() )
nxty_model_gt<-
nxty_model %>%gt() %>%
tab_header(title = "Forecast Next Year Model.",
subtitle = "From Sep 2024 To Aug 2025") %>%
tab_row_group(label = "2024",rows = Date<"2025-1-1",id ="2024" ,group = "2024") %>%
tab_row_group(label = "2025",rows = Date>="2025-1-1",id ="2025" ,group = "2025") %>%
tab_stubhead(label = "Year") %>%
fmt_number(columns =c(2:6) ,decimals = 2) %>%
row_group_order(groups = c("2024","2025")) %>%
summary_rows(groups = everything(),columns = c(2:6),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() ) %>%
tab_style(style =list(cell_fill(color="#dcdde1"),cell_text(color="black",weight = "bold")) ,locations =cells_row_groups() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stub_summary() )
nxty_model %>% pivot_longer(!Date,names_to = "cat",values_to = "values")
nxty_model %>% pivot_longer(!Date,names_to = "cat",values_to = "values") %>% mutate(Date=as.POSIXct(Date)) %>%
ggplot(aes(x=Date,y=values,color=cat,group=cat))+geom_line(size=0.8)+theme_bw()
nxty_model %>% pivot_longer(!Date,names_to = "cat",values_to = "values") %>% mutate(Date=as.POSIXct(Date)) %>%
ggplot(aes(x=Date,y=values,color=cat,group=cat))+geom_line(size=0.8)+
theme_bw()+labs(x="",y="")+
theme(axis.text.x = element_text(size=10,color="black",face = "bold"),
axis.text.y = element_text(size=10,color="black",face = "bold"))+
scale_y_continuous(breaks = c(500,1000,1500,2000,2500,3000,3500))+
scale_x_datetime(breaks = "month",date_labels = "%b %Y")
nxty_model %>% pivot_longer(!Date,names_to = "cat",values_to = "values") %>% mutate(Date=as.POSIXct(Date)) %>%
ggplot(aes(x=Date,y=values,color=cat,group=cat))+geom_line(size=0.8)+
theme_bw()+labs(x="",y="")+
theme(axis.text.x = element_text(size=10,color="black",face = "bold"),
axis.text.y = element_text(size=10,color="black",face = "bold"))+
scale_x_datetime(breaks = "month",date_labels = "%b %Y")
nxty_model %>% mutate(Hi=(Hi.95+Hi.80)/2,Low=(Lo.95+Lo.80)/2)%>%select(Date,Point.Forecast,Hi,Low) %>%
pivot_longer(!Date,names_to = "cat",values_to = "values") %>%
mutate(Date=as.POSIXct(Date)) %>%
ggplot(aes(x=Date,y=values,color=cat,group=cat))+geom_line(size=0.8)+
theme_bw()+labs(x="",y="")+
theme(axis.text.x = element_text(size=10,color="black",face = "bold"),
axis.text.y = element_text(size=10,color="black",face = "bold"))+
scale_x_datetime(breaks = "month",date_labels = "%b %Y")
nxty_model %>% mutate(Hi=(Hi.95+Hi.80)/2,Low=(Lo.95+Lo.80)/2)%>%select(Date,Point.Forecast,Hi,Low) %>%
pivot_longer(!Date,names_to = "Forecast",values_to = "values") %>%
mutate(Date=as.POSIXct(Date)) %>%
ggplot(aes(x=Date,y=values,color=cat,group=Forecast))+geom_line(size=0.8)+
theme_bw()+labs(x="",y="")+
theme(axis.text.x = element_text(size=10,color="black",face = "bold"),
axis.text.y = element_text(size=10,color="black",face = "bold"))+
scale_x_datetime(breaks = "month",date_labels = "%b %Y")
nxty_model %>% mutate(Hi=(Hi.95+Hi.80)/2,Low=(Lo.95+Lo.80)/2)%>%select(Date,Point.Forecast,Hi,Low) %>%
pivot_longer(!Date,names_to = "Forecast",values_to = "values") %>%
mutate(Date=as.POSIXct(Date)) %>%
ggplot(aes(x=Date,y=values,color=Forecast,group=Forecast))+geom_line(size=0.8)+
theme_bw()+labs(x="",y="")+
theme(axis.text.x = element_text(size=10,color="black",face = "bold"),
axis.text.y = element_text(size=10,color="black",face = "bold"))+
scale_x_datetime(breaks = "month",date_labels = "%b %Y")
daily<-eth %>% group_by(Date) %>% summarize(price=mean(price))
daily %>% view()
dtrain<-daily[c(1:2122),]
dtest<-daily[c(2123;2467),]
dtrain<-daily[c(1:2122),]
dtest<-daily[c(2123,2467),]
dtrain
dts<-ts(dtrain$price,start = c(2017,11),end = c(2024,8),frequency = 365)
autoplot(dts)
autoplot(decompose(diff( dts)))
da<-auto.arima(dts)
dtest
dtest %>% view()
daily %>% view()
dtest<-daily[c(2123:2467),]
dtest %>% view()
df<-forecast(da,h = 345)
autoplot(df)
df
rm(daily)
rm(da)
rm(df)
rm(dts)
rm(dtrain)
rm(dtest)
wkm<-eth %>% group_by(wk) %>% summarize(price=mean(price))
wkm %>% view()
wkts<-ts(wkm$price,start = c(2017,11),end =c(2023,8) ,frequency =52 )
wkm %>% view()
wkm[c(304:353),]
wkm[c(304:353),] %>% view()
wtest<-wkm[c(304:353),]
wka<-auto.arima(wkts)
wkf<-forecast(wka,h = 50)
autoplot(wkf)
wkf<-forecast(wka,h = 50,level = c(95))
autoplot(wkf)
wkf
wkf<-forecast(wka,h = 50)
wkf
