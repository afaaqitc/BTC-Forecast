subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2023",rows = Date<"2024-1-1",id ="2023" ,group = "2023") %>%
tab_row_group(label = "2024",rows = Date>="2024-1-1",id ="2024" ,group = "2024") %>%
fmt_number(columns =c(2:5) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:5),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_spanner(label = "Forecast",columns = c(3:5))%>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_spanners() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() )
mnfd %>% gt %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2023",rows = Date<"2024-1-1",id ="2023" ,group = "2023") %>%
tab_row_group(label = "2024",rows = Date>="2024-1-1",id ="2024" ,group = "2024") %>%
fmt_number(columns =c(2:5) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:5),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_spanner(label = "Forecast",columns = c(3:5))%>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_spanners() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() )
mnfd %>% gt %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2023",rows = Date<"2024-1-1",id ="2023" ,group = "2023") %>%
tab_row_group(label = "2024",rows = Date>="2024-1-1",id ="2024" ,group = "2024") %>%
fmt_number(columns =c(2:5) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:5),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_spanner(label = "Forecast",columns = c(3:5))%>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_spanners() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() ) %>%
tab_stubhead(label = "Year")
mnfd %>% gt %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2023",rows = Date<"2024-1-1",id ="2023" ,group = "2023") %>%
tab_row_group(label = "2024",rows = Date>="2024-1-1",id ="2024" ,group = "2024") %>%
fmt_number(columns =c(2:5) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:5),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_spanner(label = "Forecast",columns = c(3:5))%>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_spanners() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() ) %>%
tab_stubhead(label = "Year") %>%
tab_style(style =list(cell_fill(color="#dcdde1"),cell_text(color="black",weight = "bold")) ,locations =cells_row_groups() )
mnfd %>% gt %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2023",rows = Date<"2024-1-1",id ="2023" ,group = "2023") %>%
tab_row_group(label = "2024",rows = Date>="2024-1-1",id ="2024" ,group = "2024") %>%
fmt_number(columns =c(2:5) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:5),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_spanner(label = "Forecast",columns = c(3:5))%>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_spanners() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() ) %>%
tab_stubhead(label = "Year") %>%
tab_style(style =list(cell_fill(color="#dcdde1"),cell_text(color="black",weight = "bold")) ,locations =cells_row_groups() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stub_summary() )
mnfd_gt<-
mnfd %>% gt %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2023",rows = Date<"2024-1-1",id ="2023" ,group = "2023") %>%
tab_row_group(label = "2024",rows = Date>="2024-1-1",id ="2024" ,group = "2024") %>%
fmt_number(columns =c(2:5) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:5),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_spanner(label = "Forecast",columns = c(3:5))%>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_spanners() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() ) %>%
tab_stubhead(label = "Year") %>%
tab_style(style =list(cell_fill(color="#dcdde1"),cell_text(color="black",weight = "bold")) ,locations =cells_row_groups() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stub_summary() )
summary(lm(price~.,data = mnfd))
summary(lm(price~Hi,data = mnfd))
summary(lm(price~Hi+FPrice,data = mnfd))
summary(lm(price~Hi,data = mnfd))
plot(lm(price~Hi,data = mnfd))
summary(lm(price~Hi,data = mnfd))
modts<-ts(mn$price,start = c(2017,11),end =c(2024,8) ,frequency = 12)
autoplot(modts)
autoplot(decompose(diff( modts)))
moda<-auto.arima(modts)
modf<-forecast(moda,h = 12)
autoplot(modf)
modf
rownames_to_column(data.frame(modf))
data.frame(seq(as.Date("2024-9-1"),by="month",len12))
data.frame(seq(as.Date("2024-9-1"),by="month",len=12))
data.frame(Date=seq(as.Date("2024-9-1"),by="month",len=12))
cbind(
rownames_to_column(data.frame(modf))
,
data.frame(Date=seq(as.Date("2024-9-1"),by="month",len=12))
)
cbind(
data.frame(Date=seq(as.Date("2024-9-1"),by="month",len=12)),
rownames_to_column(data.frame(modf))
)
cbind(
data.frame(Date=seq(as.Date("2024-9-1"),by="month",len=12)),
rownames_to_column(data.frame(modf))
) %>% select(-1)
cbind(
data.frame(Date=seq(as.Date("2024-9-1"),by="month",len=12)),
rownames_to_column(data.frame(modf))
) %>% select(-2)
nxty_model<-
cbind(
data.frame(Date=seq(as.Date("2024-9-1"),by="month",len=12)),
rownames_to_column(data.frame(modf))
) %>% select(-2)
summary(lm(Point.Forecast~.,data = nxty_model))
nxty_model
nxty_model %>% select(-1)
nxty_model %>% select(-1) %>% lm(point.Forecast~.)
nxty_model %>% select(-1) %>% lm(point.Forecast~,m)
summary(lm(,data = nxty_model[,c(-1)]))
summary(lm(Point.Forecast~.,data = nxty_model[,c(-1)]))
summary(lm(Point.Forecast~.,data = nxty_model[,c(-1)]))
pairs(nxty_model[,c(-1)])
nxty_model<-
cbind(
data.frame(Date=seq(as.Date("2024-9-1"),by="month",len=12)),
rownames_to_column(data.frame(modf))
)
nxty_model
cbind(data.frame(Date=seq(as.Date("2024-9-1"),by="month",len=12)),
rownames_to_column(data.frame(modf))) %>% select(-2)
nxty_model<-
cbind(data.frame(Date=seq(as.Date("2024-9-1"),by="month",len=12)),
rownames_to_column(data.frame(modf))) %>% select(-2)
mnfd %>% gt %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2024",rows = Date<"2025-1-1",id ="2024" ,group = "2024") %>%
tab_row_group(label = "2025",rows = Date>="2025-1-1",id ="2025" ,group = "2025") %>%
fmt_number(columns =c(2:6) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:6),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_spanner(label = "Forecast",columns = c(3:6))%>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_spanners() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() ) %>%
tab_stubhead(label = "Year") %>%
tab_style(style =list(cell_fill(color="#dcdde1"),cell_text(color="black",weight = "bold")) ,locations =cells_row_groups() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stub_summary() )
nxty_model
nxty_model %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2024",rows = Date<"2025-1-1",id ="2024" ,group = "2024") %>%
tab_row_group(label = "2025",rows = Date>="2025-1-1",id ="2025" ,group = "2025") %>%
fmt_number(columns =c(2:6) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:6),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_spanner(label = "Forecast",columns = c(3:6))%>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_spanners() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() ) %>%
tab_stubhead(label = "Year") %>%
tab_style(style =list(cell_fill(color="#dcdde1"),cell_text(color="black",weight = "bold")) ,locations =cells_row_groups() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stub_summary() )
nxty_model %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2024",rows = Date<"2025-1-1",id ="2024" ,group = "2024") %>%
tab_row_group(label = "2025",rows = Date>="2025-1-1",id ="2025" ,group = "2025") %>%
fmt_number(columns =c(2:6) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:6),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() ) %>%
tab_stubhead(label = "Year") %>%
tab_style(style =list(cell_fill(color="#dcdde1"),cell_text(color="black",weight = "bold")) ,locations =cells_row_groups() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stub_summary() )
nxty_model %>%gt() %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2024",rows = Date<"2025-1-1",id ="2024" ,group = "2024") %>%
tab_row_group(label = "2025",rows = Date>="2025-1-1",id ="2025" ,group = "2025") %>%
fmt_number(columns =c(2:6) ,decimals = 2) %>%
row_group_order(groups = c("2023","2024")) %>%
summary_rows(groups = everything(),columns = c(2:6),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() ) %>%
tab_stubhead(label = "Year") %>%
tab_style(style =list(cell_fill(color="#dcdde1"),cell_text(color="black",weight = "bold")) ,locations =cells_row_groups() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stub_summary() )
nxty_model %>%gt() %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2024",rows = Date<"2025-1-1",id ="2024" ,group = "2024") %>%
tab_row_group(label = "2025",rows = Date>="2025-1-1",id ="2025" ,group = "2025") %>%
fmt_number(columns =c(2:6) ,decimals = 2) %>%
row_group_order(groups = c("2024","2025")) %>%
summary_rows(groups = everything(),columns = c(2:6),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() ) %>%
tab_stubhead(label = "Year") %>%
tab_style(style =list(cell_fill(color="#dcdde1"),cell_text(color="black",weight = "bold")) ,locations =cells_row_groups() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stub_summary() )
nxty_model %>%gt() %>%
tab_header(title = "Detect Forecast Model For Last Data",
subtitle = "From Nov 2017 To Aug 2023") %>%
tab_row_group(label = "2024",rows = Date<"2025-1-1",id ="2024" ,group = "2024") %>%
tab_row_group(label = "2025",rows = Date>="2025-1-1",id ="2025" ,group = "2025") %>%
tab_stubhead(label = "Year") %>%
fmt_number(columns =c(2:6) ,decimals = 2) %>%
row_group_order(groups = c("2024","2025")) %>%
summary_rows(groups = everything(),columns = c(2:6),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() ) %>%
tab_style(style =list(cell_fill(color="#dcdde1"),cell_text(color="black",weight = "bold")) ,locations =cells_row_groups() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stub_summary() )
nxty_model_gt<-
nxty_model %>%gt() %>%
tab_header(title = "Forecast Next Year Model.",
subtitle = "From Sep 2024 To Aug 2025") %>%
tab_row_group(label = "2024",rows = Date<"2025-1-1",id ="2024" ,group = "2024") %>%
tab_row_group(label = "2025",rows = Date>="2025-1-1",id ="2025" ,group = "2025") %>%
tab_stubhead(label = "Year") %>%
fmt_number(columns =c(2:6) ,decimals = 2) %>%
row_group_order(groups = c("2024","2025")) %>%
summary_rows(groups = everything(),columns = c(2:6),
fns = list(Mean=~mean(.)),formatter = fmt_number,decimals=1) %>%
tab_style(style =list(cell_fill(color="#fbc531"),cell_text(color="black",weight = "bold")) ,locations =cells_title() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stubhead() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_summary() ) %>%
tab_style(style =list(cell_fill(color="#273c75"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_column_labels() ) %>%
tab_style(style =list(cell_fill(color="#dcdde1"),cell_text(color="black",weight = "bold")) ,locations =cells_row_groups() ) %>%
tab_style(style =list(cell_fill(color="#353b48"),cell_text(color="white",align = "center",weight = "bold")) ,locations =cells_stub_summary() )
nxty_model %>% pivot_longer(!Date,names_to = "cat",values_to = "values")
nxty_model %>% pivot_longer(!Date,names_to = "cat",values_to = "values") %>% mutate(Date=as.POSIXct(Date)) %>%
ggplot(aes(x=Date,y=values,color=cat,group=cat))+geom_line(size=0.8)+theme_bw()
nxty_model %>% pivot_longer(!Date,names_to = "cat",values_to = "values") %>% mutate(Date=as.POSIXct(Date)) %>%
ggplot(aes(x=Date,y=values,color=cat,group=cat))+geom_line(size=0.8)+
theme_bw()+labs(x="",y="")+
theme(axis.text.x = element_text(size=10,color="black",face = "bold"),
axis.text.y = element_text(size=10,color="black",face = "bold"))+
scale_y_continuous(breaks = c(500,1000,1500,2000,2500,3000,3500))+
scale_x_datetime(breaks = "month",date_labels = "%b %Y")
nxty_model %>% pivot_longer(!Date,names_to = "cat",values_to = "values") %>% mutate(Date=as.POSIXct(Date)) %>%
ggplot(aes(x=Date,y=values,color=cat,group=cat))+geom_line(size=0.8)+
theme_bw()+labs(x="",y="")+
theme(axis.text.x = element_text(size=10,color="black",face = "bold"),
axis.text.y = element_text(size=10,color="black",face = "bold"))+
scale_x_datetime(breaks = "month",date_labels = "%b %Y")
nxty_model %>% mutate(Hi=(Hi.95+Hi.80)/2,Low=(Lo.95+Lo.80)/2)%>%select(Date,Point.Forecast,Hi,Low) %>%
pivot_longer(!Date,names_to = "cat",values_to = "values") %>%
mutate(Date=as.POSIXct(Date)) %>%
ggplot(aes(x=Date,y=values,color=cat,group=cat))+geom_line(size=0.8)+
theme_bw()+labs(x="",y="")+
theme(axis.text.x = element_text(size=10,color="black",face = "bold"),
axis.text.y = element_text(size=10,color="black",face = "bold"))+
scale_x_datetime(breaks = "month",date_labels = "%b %Y")
nxty_model %>% mutate(Hi=(Hi.95+Hi.80)/2,Low=(Lo.95+Lo.80)/2)%>%select(Date,Point.Forecast,Hi,Low) %>%
pivot_longer(!Date,names_to = "Forecast",values_to = "values") %>%
mutate(Date=as.POSIXct(Date)) %>%
ggplot(aes(x=Date,y=values,color=cat,group=Forecast))+geom_line(size=0.8)+
theme_bw()+labs(x="",y="")+
theme(axis.text.x = element_text(size=10,color="black",face = "bold"),
axis.text.y = element_text(size=10,color="black",face = "bold"))+
scale_x_datetime(breaks = "month",date_labels = "%b %Y")
nxty_model %>% mutate(Hi=(Hi.95+Hi.80)/2,Low=(Lo.95+Lo.80)/2)%>%select(Date,Point.Forecast,Hi,Low) %>%
pivot_longer(!Date,names_to = "Forecast",values_to = "values") %>%
mutate(Date=as.POSIXct(Date)) %>%
ggplot(aes(x=Date,y=values,color=Forecast,group=Forecast))+geom_line(size=0.8)+
theme_bw()+labs(x="",y="")+
theme(axis.text.x = element_text(size=10,color="black",face = "bold"),
axis.text.y = element_text(size=10,color="black",face = "bold"))+
scale_x_datetime(breaks = "month",date_labels = "%b %Y")
daily<-eth %>% group_by(Date) %>% summarize(price=mean(price))
daily %>% view()
dtrain<-daily[c(1:2122),]
dtest<-daily[c(2123;2467),]
dtrain<-daily[c(1:2122),]
dtest<-daily[c(2123,2467),]
dtrain
dts<-ts(dtrain$price,start = c(2017,11),end = c(2024,8),frequency = 365)
autoplot(dts)
autoplot(decompose(diff( dts)))
da<-auto.arima(dts)
dtest
dtest %>% view()
daily %>% view()
dtest<-daily[c(2123:2467),]
dtest %>% view()
df<-forecast(da,h = 345)
autoplot(df)
df
rm(daily)
rm(da)
rm(df)
rm(dts)
rm(dtrain)
rm(dtest)
wkm<-eth %>% group_by(wk) %>% summarize(price=mean(price))
wkm %>% view()
wkts<-ts(wkm$price,start = c(2017,11),end =c(2023,8) ,frequency =52 )
wkm %>% view()
wkm[c(304:353),]
wkm[c(304:353),] %>% view()
wtest<-wkm[c(304:353),]
wka<-auto.arima(wkts)
wkf<-forecast(wka,h = 50)
autoplot(wkf)
wkf<-forecast(wka,h = 50,level = c(95))
autoplot(wkf)
wkf
wkf<-forecast(wka,h = 50)
wkf
knitr::opts_chunk$set(echo = FALSE,message = FALSE)
library(prettydoc)
library(hrbrthemes)
library(stringr)
library(janitor)
library(tidyr)
library(dplyr)
library(formattable)
library(DT)
library(gt)
library(lubridate)
library(quantmod)
library(pacman)
library(scales)
library(data.table)
library(openxlsx)
library(readxl)
library(tibble)
library(ggplot2)
library(plotly)
library(tseries)
library(forecast)
getSymbols("BTC-USD",from="2015-01-01")
btc<-rownames_to_column(data.frame(`BTC-USD`))
btc<-
btc %>% select(rowname,BTC.USD.Adjusted) %>%
rename(date=rowname,price=BTC.USD.Adjusted) %>% mutate(date=ymd(date))%>%
mutate(mn=round_date(date,"month"),wk=round_date(date,"week"))
#--------------------------------------------------------------------------
mn<-btc %>% group_by(mn) %>% summarize(price=mean(price))
#Last
mnts<-ts(mn$price,start =c(2015,1) ,end =c(2023,7) ,frequency = 12)
autoplot(decompose(diff(mnts)))
mna<-auto.arima(mnts)
mnf<-forecast(mna,h = 13)
autoplot(mnf)
detect_last<-
cbind(rownames_to_column(data.frame(mnf))
,mn[c(104:116),] ) %>% select(mn,Point.Forecast,price,Hi.80,Lo.80,Lo.95,Hi.95) %>% mutate(Hi=(Hi.80+Hi.95)/2,Low=(Lo.80+Lo.95)/2) %>% select(mn,price,Point.Forecast,Hi,Low)
detect_last_gt<-
detect_last %>% gt() %>% fmt_number(columns = c(2:5),decimals = 2) %>% fmt_date(columns = 1,date_style = "yMMM") %>% tab_row_group(label ="2023" ,rows =mn<"2023-12-31" ,id = "2023",group = "2023")%>% tab_row_group(label ="2024" ,rows =mn>="2024-1-1" ,id = "2024",group = "2024") %>% cols_label(mn="Date") %>% cols_label_with(columns = everything(),fn = toupper) %>% summary_rows(groups = everything(),columns = c(2:5),fns = list(AVG=~mean(.)),formatter = fmt_number,decimals=1) %>% row_group_order(groups = c("2023","2024")) %>% tab_header(title = "Forecast Last Year Data") %>% opt_stylize(style = 3) %>% tab_style(style =list(cell_fill(color="#eccc68"),cell_text(color="black",weight = "bold")) ,locations = cells_title()) %>% tab_style(style =list(cell_fill(color="#eccc68"),cell_text(color="black",weight = "bold")) ,locations = cells_summary()) %>% tab_style(style =list(cell_fill(color="black"),cell_text(color="white",weight = "bold")) ,locations = cells_stub_summary())%>% tab_style(style =list(cell_fill(color="#ced6e0"),cell_text(color="black",weight = "bold")) ,locations = cells_group()) %>% tab_style(style =list(cell_text(color="black",weight = "bold",align = "center")) ,locations = cells_body())
detect_last_chart<-
detect_last %>% mutate(mn=as.POSIXct(mn)) %>% select(mn,price,Point.Forecast,Hi,Low)%>%
pivot_longer(!mn,names_to = "cat",values_to = "price") %>%
ggplot(aes(x=mn,y = price,color=cat,group=cat))+geom_line()+
scale_x_datetime(date_breaks ="month" ,date_labels = "%b-%Y")+theme_bw()+
labs(x="",y="")+
scale_y_continuous(breaks = c(5000,15000,25000,35000,45000,55000,65000,75000))+
theme(axis.text.x = element_text(face = "bold",size=10,color="black",angle = 90),
axis.text.y = element_text(face = "bold",size=10,color="black"))
#Real
mrts<-ts(mn$price,start =c(2015,1) ,end =c(2024,8) ,frequency = 12)
mra<-auto.arima(mrts)
mrf<-forecast(mra,h = 12)
autoplot(mrf)
nextf<-data.frame(mn=seq(as.Date("2024-09-1"),by="month",len=12))
mn_add_gt<-
cbind(rownames_to_column(data.frame(mrf)),nextf) %>%
select(mn,Point.Forecast,Lo.95,Hi.95,Hi.80,Lo.80) %>% mutate(low=(Lo.80+Lo.95)/2,high=(Hi.80+Hi.95)/2) %>% rename(Date=mn)%>%select(Date,Point.Forecast,low,high)%>% gt() %>% fmt_number(columns = c(2:4),decimals = 2) %>% fmt_date(columns = 1,date_style = "yMMM") %>% tab_row_group(label ="2023" ,rows =Date<"2024-12-31" ,id = "2024",group = "2024")%>% tab_row_group(label ="2025" ,rows =Date>="2025-1-1" ,id = "2025",group = "2025")  %>% cols_label_with(columns = everything(),fn = toupper) %>% summary_rows(groups = everything(),columns = c(2:4),fns = list(AVG=~mean(.)),formatter = fmt_number,decimals=1) %>% row_group_order(groups = c("2024","2025")) %>% tab_header(title = "Forecast Next Year") %>% opt_stylize(style = 3) %>% tab_style(style =list(cell_fill(color="#eccc68"),cell_text(color="black",weight = "bold")) ,locations = cells_title()) %>% tab_style(style =list(cell_fill(color="#eccc68"),cell_text(color="black",weight = "bold")) ,locations = cells_summary()) %>% tab_style(style =list(cell_fill(color="black"),cell_text(color="white",weight = "bold")) ,locations = cells_stub_summary())%>% tab_style(style =list(cell_fill(color="#ced6e0"),cell_text(color="black",weight = "bold")) ,locations = cells_group()) %>% tab_style(style =list(cell_text(color="black",weight = "bold",align = "center")) ,locations = cells_body())
mn_add_chart<-
cbind(rownames_to_column(data.frame(mrf)),nextf) %>%
select(mn,Point.Forecast,Lo.95,Hi.95,Hi.80,Lo.80) %>% mutate(low=(Lo.80+Lo.95)/2,high=(Hi.80+Hi.95)/2) %>% rename(Date=mn)%>%select(Date,Point.Forecast,low,high)%>%
pivot_longer(!Date,names_to ="cat" ,values_to = "price") %>%
mutate(mn=as.POSIXct(Date))%>% filter(Date>"2017-12-31") %>%
ggplot(aes(x=mn,y=price,color=cat,group=cat))+geom_line(size=0.7)+
scale_fill_brewer(palette = "Set1")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90,color="black",size=10),
axis.text.y = element_text(color="black",size=10),
plot.title = element_text(face = "bold",colour = "brown",size = 15),
plot.subtitle = element_text(face = "bold.italic",colour = "black"))+labs(x="",y="")+
scale_x_datetime(date_breaks ="month" ,date_labels = "%b-%Y")+
scale_y_continuous(breaks =  c(30000,50000,70000,90000))
ggplotly( detect_last_chart,width = 900)
detect_last_gt
ggplotly( mn_add_chart,width = 900)
mn_add_gt
knitr::opts_chunk$set(echo = FALSE,message = FALSE)
library(prettydoc)
library(hrbrthemes)
library(stringr)
library(janitor)
library(tidyr)
library(dplyr)
library(formattable)
library(DT)
library(gt)
library(lubridate)
library(quantmod)
library(pacman)
library(scales)
library(data.table)
library(openxlsx)
library(readxl)
library(tibble)
library(ggplot2)
library(plotly)
library(tseries)
library(forecast)
getSymbols("BTC-USD",from="2015-01-01")
btc<-rownames_to_column(data.frame(`BTC-USD`))
btc<-
btc %>% select(rowname,BTC.USD.Adjusted) %>%
rename(date=rowname,price=BTC.USD.Adjusted) %>% mutate(date=ymd(date))%>%
mutate(mn=round_date(date,"month"),wk=round_date(date,"week"))
#--------------------------------------------------------------------------
mn<-btc %>% group_by(mn) %>% summarize(price=mean(price))
#Last
mnts<-ts(mn$price,start =c(2015,1) ,end =c(2023,7) ,frequency = 12)
autoplot(decompose(diff(mnts)))
mna<-auto.arima(mnts)
mnf<-forecast(mna,h = 13)
autoplot(mnf)
detect_last<-
cbind(rownames_to_column(data.frame(mnf))
,mn[c(104:116),] ) %>% select(mn,Point.Forecast,price,Hi.80,Lo.80,Lo.95,Hi.95) %>% mutate(Hi=(Hi.80+Hi.95)/2,Low=(Lo.80+Lo.95)/2) %>% select(mn,price,Point.Forecast,Hi,Low)
detect_last_gt<-
detect_last %>% gt() %>% fmt_number(columns = c(2:5),decimals = 2) %>% fmt_date(columns = 1,date_style = "yMMM") %>% tab_row_group(label ="2023" ,rows =mn<"2023-12-31" ,id = "2023",group = "2023")%>% tab_row_group(label ="2024" ,rows =mn>="2024-1-1" ,id = "2024",group = "2024") %>% cols_label(mn="Date") %>% cols_label_with(columns = everything(),fn = toupper) %>% summary_rows(groups = everything(),columns = c(2:5),fns = list(AVG=~mean(.)),formatter = fmt_number,decimals=1) %>% row_group_order(groups = c("2023","2024")) %>% tab_header(title = "Forecast Last Year Data") %>% opt_stylize(style = 3) %>% tab_style(style =list(cell_fill(color="#eccc68"),cell_text(color="black",weight = "bold")) ,locations = cells_title()) %>% tab_style(style =list(cell_fill(color="#eccc68"),cell_text(color="black",weight = "bold")) ,locations = cells_summary()) %>% tab_style(style =list(cell_fill(color="black"),cell_text(color="white",weight = "bold")) ,locations = cells_stub_summary())%>% tab_style(style =list(cell_fill(color="#ced6e0"),cell_text(color="black",weight = "bold")) ,locations = cells_group()) %>% tab_style(style =list(cell_text(color="black",weight = "bold",align = "center")) ,locations = cells_body())
detect_last_chart<-
detect_last %>% mutate(mn=as.POSIXct(mn)) %>% select(mn,price,Point.Forecast,Hi,Low)%>%
pivot_longer(!mn,names_to = "cat",values_to = "price") %>%
ggplot(aes(x=mn,y = price,color=cat,group=cat))+geom_line()+
scale_x_datetime(date_breaks ="month" ,date_labels = "%b-%Y")+theme_bw()+
labs(x="",y="")+
scale_y_continuous(breaks = c(5000,15000,25000,35000,45000,55000,65000,75000))+
theme(axis.text.x = element_text(face = "bold",size=10,color="black",angle = 90),
axis.text.y = element_text(face = "bold",size=10,color="black"))
#Real
mrts<-ts(mn$price,start =c(2015,1) ,end =c(2024,8) ,frequency = 12)
mra<-auto.arima(mrts)
mrf<-forecast(mra,h = 12)
autoplot(mrf)
nextf<-data.frame(mn=seq(as.Date("2024-09-1"),by="month",len=12))
mn_add_gt<-
cbind(rownames_to_column(data.frame(mrf)),nextf) %>%
select(mn,Point.Forecast,Lo.95,Hi.95,Hi.80,Lo.80) %>% mutate(low=(Lo.80+Lo.95)/2,high=(Hi.80+Hi.95)/2) %>% rename(Date=mn)%>%select(Date,Point.Forecast,low,high)%>% gt() %>% fmt_number(columns = c(2:4),decimals = 2) %>% fmt_date(columns = 1,date_style = "yMMM") %>% tab_row_group(label ="2024" ,rows =Date<"2024-12-31" ,id = "2024",group = "2024")%>% tab_row_group(label ="2025" ,rows =Date>="2025-1-1" ,id = "2025",group = "2025")  %>% cols_label_with(columns = everything(),fn = toupper) %>% summary_rows(groups = everything(),columns = c(2:4),fns = list(AVG=~mean(.)),formatter = fmt_number,decimals=1) %>% row_group_order(groups = c("2024","2025")) %>% tab_header(title = "Forecast Next Year") %>% opt_stylize(style = 3) %>% tab_style(style =list(cell_fill(color="#eccc68"),cell_text(color="black",weight = "bold")) ,locations = cells_title()) %>% tab_style(style =list(cell_fill(color="#eccc68"),cell_text(color="black",weight = "bold")) ,locations = cells_summary()) %>% tab_style(style =list(cell_fill(color="black"),cell_text(color="white",weight = "bold")) ,locations = cells_stub_summary())%>% tab_style(style =list(cell_fill(color="#ced6e0"),cell_text(color="black",weight = "bold")) ,locations = cells_group()) %>% tab_style(style =list(cell_text(color="black",weight = "bold",align = "center")) ,locations = cells_body())
mn_add_chart<-
cbind(rownames_to_column(data.frame(mrf)),nextf) %>%
select(mn,Point.Forecast,Lo.95,Hi.95,Hi.80,Lo.80) %>% mutate(low=(Lo.80+Lo.95)/2,high=(Hi.80+Hi.95)/2) %>% rename(Date=mn)%>%select(Date,Point.Forecast,low,high)%>%
pivot_longer(!Date,names_to ="cat" ,values_to = "price") %>%
mutate(mn=as.POSIXct(Date))%>% filter(Date>"2017-12-31") %>%
ggplot(aes(x=mn,y=price,color=cat,group=cat))+geom_line(size=0.7)+
scale_fill_brewer(palette = "Set1")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90,color="black",size=10),
axis.text.y = element_text(color="black",size=10),
plot.title = element_text(face = "bold",colour = "brown",size = 15),
plot.subtitle = element_text(face = "bold.italic",colour = "black"))+labs(x="",y="")+
scale_x_datetime(date_breaks ="month" ,date_labels = "%b-%Y")+
scale_y_continuous(breaks =  c(30000,50000,70000,90000))
ggplotly( detect_last_chart,width = 900)
detect_last_gt
ggplotly( mn_add_chart,width = 900)
mn_add_gt
mn_etc<-ets(mnts)
mnff<-forecast(mn_etc,h = 13)
mnff
